---
import Base from '../../layouts/Base.astro';
import Nav from '../../components/ui/Nav.astro';
import Footer from '../../components/ui/Footer.astro';
import ProjectCard from '../../components/ui/ProjectCard.astro';
import CitationCard from '../../components/ui/CitationCard.astro';
import HeroSimulation from '../../components/interactive/HeroSimulation.astro';
import { t, getSite, localizedPath } from '../../i18n/utils';
import citations from '../../data/citations.json';
import { getCollection } from 'astro:content';

const lang = 'ja';
const site = getSite(lang);
const posts = await getCollection('blog', ({ data }) => !data.draft && data.locale === 'ja');
posts.sort((a, b) => a.data.order - b.data.order);
---

<Base lang={lang}>
  <Nav lang={lang} />

  <!-- Hero -->
  <section
    class="min-h-screen flex items-center justify-center text-center bg-cover bg-center relative"
    style={`background-image: url(${site.heroImage})`}
    id="hero"
  >
    <HeroSimulation />
    <div id="hero-overlay" class="absolute inset-0 bg-white/80 dark:bg-black/75"></div>
    <div class="px-4 relative z-10">
      <h1 class="font-bold tracking-wide text-gray-900 dark:text-white" style="font-size: 3rem;">
        {site.title}
      </h1>
      <p class="text-gray-600 dark:text-gray-200 uppercase tracking-wide mt-4 text-lg">
        {site.description}
      </p>
      <hr class="border-gray-300 dark:border-white my-6 mx-auto" style="width: 90vw;" />
      <p class="text-gray-900 dark:text-white max-w-xl mx-auto text-sm leading-relaxed">
        {site.author.intro}
      </p>
    </div>
  </section>

  <!-- Posts -->
  <section class="bg-gray-100 dark:bg-gray-900 py-16" id="blog" style="scroll-margin-top: 4rem;">
    <div class="max-w-6xl mx-auto px-4">
      <div class="flex flex-wrap justify-center gap-4">
        {posts.map((post) => (
          <ProjectCard
            title={post.data.title}
            description={post.data.description}
            image={post.data.image || ''}
            href={`/ja/blog/${post.slug.replace(/^ja\//, '')}/`}
          />
        ))}
      </div>
    </div>
  </section>

  <!-- Papers -->
  <section class="bg-white dark:bg-black py-8" id="publications" style="scroll-margin-top: 4rem;">
    <div class="max-w-4xl mx-auto px-4">
      <p class="text-gray-400 dark:text-gray-500 text-xs uppercase tracking-wider mb-6">
        {t(lang, 'footer.papers')}
      </p>
      <div class="space-y-4">
        {citations.map((cite) => (
          <CitationCard {...cite} />
        ))}
      </div>
    </div>
  </section>

  <Footer lang={lang} />
</Base>