---
import Page from '../../layouts/Page.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog', ({ data }) => !data.draft);
posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Page title="Blog">
  <div class="pt-24 pb-16 max-w-3xl mx-auto px-4">
    <h1 class="text-4xl font-bold text-white mb-8">Blog</h1>
    {posts.length === 0 ? (
      <p class="text-gray-500">No posts yet. Check back soon.</p>
    ) : (
      <div class="space-y-8">
        {posts.map((post) => (
          <a href={`/blog/${post.slug}`} class="block group">
            <article class="border-b border-gray-800 pb-6">
              <h2 class="text-xl font-semibold text-white group-hover:text-gray-300 transition-colors">
                {post.data.title}
              </h2>
              <time class="text-gray-500 text-sm mt-1 block">
                {post.data.date.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </time>
              <p class="text-gray-400 mt-2">{post.data.description}</p>
              {post.data.tags.length > 0 && (
                <div class="flex gap-2 mt-2">
                  {post.data.tags.map((tag) => (
                    <span class="bg-gray-800 text-gray-400 text-xs px-2 py-1 rounded">{tag}</span>
                  ))}
                </div>
              )}
            </article>
          </a>
        ))}
      </div>
    )}
  </div>
</Page>
