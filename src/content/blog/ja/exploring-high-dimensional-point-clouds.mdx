---
title: "高次元点群の探索"
description: "高次元点群を探索するためのアプリケーション。"
date: 2023-12-15
image: "/images/flowatlas-thumbnail.mp4"
tags: ["データ可視化", "Julia", "フローサイトメトリー"]
order: 4
locale: "ja"
---

### フローサイトメトリーとは何か、なぜ高次元なのか？

フローサイトメトリーは、数億個の細胞を含む可能性のある生物学的サンプル内の異なる細胞タイプを識別するための強力な技術です。以下は、細胞がどのようにして高次元の点になるかを示す簡略化した模式図です。

<figure>
  <img src="/images/cytometer.png" alt="フローサイトメーターの模式図" />
  <figcaption>a) フローサイトメーターの模式図：細胞は一列に並んでレーザーに提示される。レーザーにより各細胞から蛍光が発生し、検出器で測定される。b) ゲーティング戦略により、二次元投影を通じて細胞タイプが識別される。各細胞は実際には蛍光測定値を成分とする高次元の点である。</figcaption>
</figure>

### OpenLayersを使ったギガスケール点群のナビゲーション

二次元投影による高次元データの探索の代わりに、自己組織化マップ（<a href="https://pubmed.ncbi.nlm.nih.gov/33205814/">M. Kratochvil et al. 2020</a>）などの次元削減手法は、点群の高次元空間に埋め込まれた二次元多様体を学習し、すべての点への射影距離を最小化できます。

これらの二次元埋め込みは、異なる細胞タイプとその関係性の質的な概要を提供するため、シングルセルデータセットを含む論文で非常に人気のある図です。しかし、データセットが数億点に達すると、これらの図は情報過多になり、一度にすべてを表示しようとして見づらくなります。

ここで<a href="https://openlayers.org/">OpenLayers</a>が役立ちます。固定解像度でデータセット全体をレンダリングする代わりに、埋め込まれたデータセットをタイル化し、異なる解像度の四分木として整理します。ビューボックスの範囲と希望するズームレベルを使って、<a href="https://docs.maptiler.com/google-maps-coordinates-tile-bounds-projection/#7/-55.46/-22.85">必要に応じてタイルをレンダリング</a>します。地球全体の衛星画像データをナビゲートする際にも同じアルゴリズムが使用されており、数百GBのデータをメモリにロードする必要がありません。

このデータ可視化に、静的な図のパネルとして存在するようなインタラクティブ機能を、<a href="https://d3js.org/">D3.js</a>を使って追加できます。下の図では、各点をその細胞で測定された蛍光測定値で色分けすることで、埋め込みの異なるクラスターが何を表しているかを識別できます。

<figure>
  <video autoplay loop muted playsinline src="/images/channels.mp4" aria-label="点群の再着色"></video>
  <figcaption>異なる蛍光測定値により数億の点を瞬時に再着色し、点群内の異なるクラスターの意味を識別する</figcaption>
</figure>

この機能やその他のデータ探索機能は<a href="https://github.com/gszep/FlowAtlas.jl">FlowAtlas.jl</a>で利用できます。

### 参考文献

V. Coppard, G. Szep et al. 2023. FlowAtlas.jl: an interactive tool bridging FlowJo with computational tools in Julia. bioRxiv, 2023.12.21.572741

MetaCarta and Dev Team. OpenLayers, 2006.