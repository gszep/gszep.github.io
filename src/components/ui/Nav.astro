---
import site from '../../data/site.json';
import ThemeToggle from './ThemeToggle.astro';

const currentPath = Astro.url.pathname;
const isHome = currentPath === '/';
---

<nav class="fixed top-0 w-full bg-white dark:bg-black z-50" role="navigation" aria-label="main navigation">
  <div class="max-w-6xl mx-auto px-4 flex items-center justify-between h-16">
    <a href="/" class="font-bold text-gray-900 dark:text-white text-lg">{site.title}</a>

    <!-- Desktop nav -->
    <div class="hidden md:flex items-center gap-6 text-sm uppercase tracking-wide">
      <a href="/" class:list={["hover:text-gray-900 dark:hover:text-gray-300", { 'text-gray-900 dark:text-white': isHome, 'text-gray-500 dark:text-gray-400': !isHome }]}>Home</a>
      <a href="/#blog" class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">Blog</a>
      <a href="/#publications" class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">Publications</a>
      <a href="/#contact" class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-300">Contact</a>
      <ThemeToggle />
    </div>

    <!-- Mobile: toggle + burger -->
    <div class="flex items-center gap-2 md:hidden">
      <ThemeToggle />
      <button
        class="text-gray-900 dark:text-white"
        id="nav-burger"
        aria-label="Toggle navigation"
        aria-expanded="false"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile menu -->
  <div class="hidden md:hidden bg-white dark:bg-black px-4 pb-4" id="nav-menu">
    <a href="/" class="block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Home</a>
    <a href="/#blog" class="block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Blog</a>
    <a href="/#publications" class="block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Publications</a>
    <a href="/#contact" class="block py-2 text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white uppercase text-sm">Contact</a>
  </div>
</nav>

<script>
  const burger = document.getElementById('nav-burger');
  const menu = document.getElementById('nav-menu');
  burger?.addEventListener('click', () => {
    menu?.classList.toggle('hidden');
    const expanded = burger.getAttribute('aria-expanded') === 'true';
    burger.setAttribute('aria-expanded', String(!expanded));
  });
  menu?.querySelectorAll('a').forEach((link) => {
    link.addEventListener('click', () => {
      menu.classList.add('hidden');
      burger?.setAttribute('aria-expanded', 'false');
    });
  });
</script>
