---
interface Props {
  block?: boolean;
}

const { block = true } = Astro.props;
---

{block ? (
  <div class="equation-block my-6 text-center overflow-x-auto">
    <span class="katex-display"><slot /></span>
  </div>
) : (
  <span class="katex-inline"><slot /></span>
)}

<script>
  import katex from 'katex';

  function renderEquations() {
    document.querySelectorAll('.katex-display, .katex-inline').forEach((el) => {
      const tex = el.textContent?.trim();
      if (tex && !el.querySelector('.katex')) {
        const isBlock = el.classList.contains('katex-display');
        el.innerHTML = katex.renderToString(tex, {
          displayMode: isBlock,
          throwOnError: false,
        });
      }
    });
  }

  renderEquations();
</script>

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css"
  crossorigin="anonymous"
/>
